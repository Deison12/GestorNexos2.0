"use strict";(self.webpackChunknowa=self.webpackChunknowa||[]).push([[7857],{34933:function(e,t,s){s.r(t);var n=s(93433),a=s(45987),r=s(4942),l=s(1413),i=s(74165),o=s(15861),c=s(29439),u=s(72791),d=s(20160),m=s(79627),v=s(2677),f=s(89743),p=s(323),x=s(43360),h=s(16871),Z=s(24490),j=s(42713),g=s(82570),b=s.n(g),y=s(78983),N=s(20409),_=s(99366),E=s(8373),w=s(80184),k=["name","status_files"],C=["id","status_file"],S={id:0,name:"",status_id:1,status_files:1,files:[],deleted:[]},L={subject:"",message:"",service_id:"",name_email:""};t.default=function(){var e,t,s,g,F,O=(0,h.TH)(),A=O.state,R=(0,u.useState)(S),D=(0,c.Z)(R,2),q=D[0],I=D[1],T=(0,Z.ib)(),B=T.getAllData,U=T.postData,z=(0,u.useState)([]),H=(0,c.Z)(z,2),P=H[0],M=H[1],G=(0,u.useState)(0),V=(0,c.Z)(G,2),Y=V[0],J=V[1],K=(0,Z.VY)(),Q=K.handleEditConfirmation,W=K.handleErrorAlert,X=(0,u.useState)(!1),$=(0,c.Z)(X,2),ee=$[0],te=$[1],se=(0,u.useState)(L),ne=(0,c.Z)(se,2),ae=ne[0],re=ne[1],le=(0,u.useState)(!0),ie=(0,c.Z)(le,2),oe=ie[0],ce=ie[1],ue=function(e){new Promise((function(t,s){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return s(e)}}))},de=(0,u.useState)(!1),me=(0,c.Z)(de,2),ve=me[0],fe=me[1],pe=(0,u.useState)(""),xe=(0,c.Z)(pe,2),he=xe[0],Ze=xe[1],je=(0,u.useState)(""),ge=(0,c.Z)(je,2),be=ge[0],ye=ge[1],Ne=(0,u.useState)([]),_e=(0,c.Z)(Ne,2),Ee=_e[0],we=_e[1],ke=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,ue(t.originFileObj);case 3:t.preview=e.sent;case 4:Ze(t.url||t.preview),fe(!0),ye(t.name||t.url.substring(t.url.lastIndexOf("/")+1));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=(0,w.jsxs)("div",{children:[(0,w.jsx)(N.Z,{style:{fontSize:"70px"},children:"add_circle"}),(0,w.jsx)("div",{style:{marginTop:8},children:"Subir Archivo"})]}),Se=function(e){var t=(0,l.Z)({},ae),s=e.target,n=s.name,a=s.value,i="radio"===s.type?parseInt(a):a;"name_email"===n&&ee&&(""===(a=a.trim())||b().isEmpty(a)?t.name_email="El campo nombre es obligatorio":delete t.name_email,I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,r.Z)({},n,i))}))),"subject"===n&&ee&&(""===(a=a.trim())||b().isEmpty(a)?t.subject="El campo asunto es obligatorio":delete t.subject,I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,r.Z)({},n,i))}))),"status_files"===n&&I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,r.Z)({},n,i))})),"service_id"===n&&("0"===a||b().isEmpty(a)?t.service_id="El campo \xe1rea es obligatorio":delete t.service_id,I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,r.Z)({},n,i))}))),"message"===n&&ee&&(""===(a=a.trim())||b().isEmpty(a)?t.message="El campo mensaje es obligatorio":delete t.message,I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,r.Z)({},n,i))}))),"status_id"===n&&I((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,r.Z)({},n,i))})),Object.keys(t).length>0?(re(t),ce(!0)):(re({}),ce(!1))},Le=function(){te(!0)},Fe=function(){var e=[];return Ee.forEach((function(t){t.url&&e.push({file:t.url})})),e},Oe=function(){var e;null!=(null===O||void 0===O||null===(e=O.state)||void 0===e?void 0:e.id)?Re():Ae()},Ae=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,q.name,q.status_files,t=(0,a.Z)(q,k),s=(0,l.Z)((0,l.Z)({},t),{},{files:Fe()}),console.log({payload:s}),e.next=6,U(s,"email/save",!1,"listacorreos");case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error en createForm:",e.t0),W("Error al crear el form.");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,s,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q("\xbfEst\xe1s seguro que deseas editar este servicio?");case 3:if(!e.sent.isConfirmed){e.next=9;break}return q.id,q.status_file,s=(0,a.Z)(q,C),n=(0,l.Z)((0,l.Z)({},s),{},{id:null===O||void 0===O||null===(t=O.state)||void 0===t?void 0:t.id,files:Fe()}),e.next=9,U(n,"email/save",!1,"listacorreos");case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error en editForm:",e.t0),W("Error al editar el form.");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B("api/services/activeTypes");case 3:t=e.sent,M(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){if(null!==A&&void 0!==A&&A.id){var e,t=0;if((null===A||void 0===A||null===(e=A.files)||void 0===e?void 0:e.length)>0){var s=[];null===A||void 0===A||A.files.forEach((function(e,t){s.push({id:"".concat(null===e||void 0===e?void 0:e.id),name:"Adjunto ".concat(t+1),url:null===e||void 0===e?void 0:e.photo})})),t=1,we(s)}else t=0;I((0,l.Z)((0,l.Z)({},A),{},{deleted:[],status_files:t})),J(A.service_id),function(e){te(!1),ce(!0);var t={name_email:e.name_email?null:"El campo est\xe1 vac\xedo",subject:e.subject?null:"El campo est\xe1 vac\xedo",message:e.message?null:"El campo est\xe1 vac\xedo",service_id:e.service_id?null:"El campo est\xe1 vac\xedo"};Object.keys(t).forEach((function(e){null==t[e]&&delete t[e]})),0===Object.keys(t).length&&(te(!1),ce(!1)),re(t)}(A)}}),[A]),(0,u.useEffect)((function(){De()}),[]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j.cI,{items:["INICIO","LISTA DE CORREOS",null!==O&&void 0!==O&&null!==(e=O.state)&&void 0!==e&&e.id?"Editar correo":"Agregar correo"],baseURL:["inicio","nexos/listacorreos",null!==O&&void 0!==O&&null!==(t=O.state)&&void 0!==t&&t.id?"editarcorreo/"+(null===O||void 0===O||null===(s=O.state)||void 0===s?void 0:s.id):"editarcorreo"]}),(0,w.jsx)(j.r3,{title:null!==O&&void 0!==O&&null!==(g=O.state)&&void 0!==g&&g.id?"Editar correo":"Agregar correo"}),(0,w.jsx)(d.Z,{className:"form-horizontal",onSubmit:function(e){e.preventDefault(),Oe()},children:(0,w.jsx)(m.Z,{className:"w-100",children:(0,w.jsx)(m.Z.Body,{className:"w-100",children:(0,w.jsxs)(v.Z,{sm:12,md:12,lg:12,xl:10,className:"mx-auto",children:[(0,w.jsxs)(f.Z,{className:"w-100 justify-content-center justify-content-md-between mt-5 mb-3",children:[(0,w.jsxs)(v.Z,{sm:12,md:12,lg:5,xl:5,children:[(0,w.jsxs)(p.Z,{className:"form-group w-100 m-0",children:[(0,w.jsx)(d.Z.Label,{className:"mb-3",children:"NOMBRE DEL CORREO"}),(0,w.jsx)(j.fm,{message:null===ae||void 0===ae?void 0:ae.name_email,inputFocus:ee,children:(0,w.jsx)(y.jO,{type:"text",id:"quote-autocomplete",name:"name_email",onChange:Se,onBlur:Se,onFocus:Le,value:q.name_email?q.name_email:"",required:!0})})]}),(0,w.jsxs)(p.Z,{className:"form-group w-100 m-0",children:[(0,w.jsx)(d.Z.Label,{className:"mb-3",children:"ASUNTO"}),(0,w.jsx)(j.fm,{message:null===ae||void 0===ae?void 0:ae.subject,inputFocus:ee,children:(0,w.jsx)(y.jO,{type:"text",id:"quote-autocomplete",name:"subject",onChange:Se,onBlur:Se,onFocus:Le,value:q.subject?q.subject:"",required:!0})})]}),(0,w.jsxs)(p.Z,{className:"form-group text-center mt-5",children:[(0,w.jsx)(d.Z.Label,{className:"form-label",children:"Documentos Adjuntos"}),(0,w.jsxs)("div",{className:"custom-controls-stacked d-flex justify-content-center gap-5",children:[(0,w.jsxs)(d.Z.Label,{className:"custom-control custom-radio",children:[(0,w.jsx)(d.Z.Control,{type:"radio",className:"custom-control-input",name:"status_files",value:1,checked:1===(null===q||void 0===q?void 0:q.status_files),onChange:Se,onClick:Le}),(0,w.jsx)("span",{className:"custom-control-label",children:"Si"})]}),(0,w.jsxs)(d.Z.Label,{className:"custom-control custom-radio",children:[(0,w.jsx)(d.Z.Control,{type:"radio",className:"custom-control-input",name:"status_files",value:0,checked:0===(null===q||void 0===q?void 0:q.status_files),onChange:Se,onClick:Le}),(0,w.jsx)("span",{className:"custom-control-label",children:"No"})]})]})]})]}),(0,w.jsxs)(v.Z,{xs:12,sm:12,md:12,lg:5,xl:5,children:[(0,w.jsx)(d.Z.Label,{className:"mb-3",children:"\xc1REA"}),P.length>0&&(0,w.jsx)(j.fm,{message:ae.service_id,inputFocus:ee,children:(0,w.jsxs)(d.Z.Select,{name:"service_id","aria-label":"Default select example",className:"selectproduct w-100",value:Y,onFocus:Le,onBlur:Le,onChange:function(e){J(e.target.value),e.target.value=e.target.value.toString(),Se(e),I((0,l.Z)((0,l.Z)({},q),{},(0,r.Z)({},e.target.name,e.target.value)))},style:{border:"solid 0.5px gray",padding:8},children:[(0,w.jsx)("option",{value:0,children:"Seleccionar area"}),P.map((function(e){return(0,w.jsx)("option",{value:e.id,children:e.name},e.id)}))]})}),(0,w.jsxs)(p.Z,{className:"form-group text-center mt-5",children:[(0,w.jsx)(d.Z.Label,{className:"form-label",children:"Estado"}),(0,w.jsxs)("div",{className:"custom-controls-stacked d-flex justify-content-center gap-5",children:[(0,w.jsxs)(d.Z.Label,{className:"custom-control custom-radio",children:[(0,w.jsx)(d.Z.Control,{type:"radio",className:"custom-control-input",name:"status_id",value:1,checked:1===(null===q||void 0===q?void 0:q.status_id),onChange:Se,onClick:Le}),(0,w.jsx)("span",{className:"custom-control-label",children:"Activo"})]}),(0,w.jsxs)(d.Z.Label,{className:"custom-control custom-radio",children:[(0,w.jsx)(d.Z.Control,{type:"radio",className:"custom-control-input",name:"status_id",value:0,checked:0===(null===q||void 0===q?void 0:q.status_id),onChange:Se,onClick:Le}),(0,w.jsx)("span",{className:"custom-control-label",children:"Inactivo"})]})]})]})]})]}),(0,w.jsx)(f.Z,{className:"mb-2",children:(0,w.jsxs)(v.Z,{xs:12,sm:12,md:12,lg:12,xl:12,children:[(0,w.jsxs)(p.Z,{children:[(0,w.jsx)(d.Z.Label,{children:"Mensaje"}),(0,w.jsx)(j.fm,{message:null===ae||void 0===ae?void 0:ae.message,inputFocus:ee,children:(0,w.jsx)(d.Z.Control,{style:{height:"5.5cm",maxHeight:"5.5cm",minHeight:"2.5cm"},as:"textarea",name:"message",onFocus:Le,onChange:Se,value:null!==(F=null===q||void 0===q?void 0:q.message)&&void 0!==F?F:"",required:!0})})]}),1===(null===q||void 0===q?void 0:q.status_files)&&(0,w.jsx)(f.Z,{className:"w-100 d-flex justify-content-around align-items-center my-4",children:(0,w.jsx)("div",{className:"d-flex justify-content-center",children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(_.Z,{listType:"picture-card",accept:".jpg,.jpeg,.png,.pdf,.xls,.xlsx",fileList:Ee,onPreview:ke,customRequest:function(e){e.onSuccess,e.onError;var t=e.file,s=(e.onProgress,new FileReader);s.addEventListener("load",(function(e){var s,a=null===(s=e.target)||void 0===s?void 0:s.result,r={name:t.name,url:a};we((function(e){return[].concat((0,n.Z)(e),[r])}))})),s.readAsDataURL(t)},onRemove:function(e){var t=Ee.filter((function(t){return t.id!==e.id}));I((function(s){return(0,l.Z)((0,l.Z)({},s),{},{files:t,deleted:[{id:e.id}].concat((0,n.Z)(null===s||void 0===s?void 0:s.deleted))})})),we(t)},beforeUpload:function(e){return!(e.size>26214400)||(W("El adjunto no puede superar el tama\xf1o requerido (25 megabytes)"),!1)},children:Ee.length>=10?null:Ce}),(0,w.jsx)(E.Z,{open:ve,title:be,footer:null,onCancel:function(){return fe(!1)},children:(0,w.jsx)("img",{alt:"example",style:{width:"100%"},src:he})})]})})})]})}),(0,w.jsx)(f.Z,{className:"mb-4",children:(0,w.jsx)(v.Z,{xs:12,sm:12,md:12,lg:12,xl:12,children:(0,w.jsx)(x.Z,{variant:"",className:"btn btn-primary",style:{width:"100%"},type:"submit",disabled:oe,children:A?"Guardar cambios":"Editar cambios"})})})]})})})})]})}}}]);
//# sourceMappingURL=7857.fe6489c9.chunk.js.map