"use strict";(self.webpackChunknowa=self.webpackChunknowa||[]).push([[6923],{71714:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var i=n(74165),o=n(15861),a=n(93433),r=n(1413),c=n(45987),s=n(29439),l=n(72791),d=n(42713),u=n(16871),v=n(45644),f=n(89743),m=n(2677),p=n(81694),Z=n.n(p),x=n(10162),h=n(80184),b=["bsPrefix","fluid","as","className"],g=l.forwardRef((function(e,t){var n=e.bsPrefix,i=e.fluid,o=e.as,a=void 0===o?"div":o,s=e.className,l=(0,c.Z)(e,b),d=(0,x.vE)(n,"container"),u="string"===typeof i?"-".concat(i):"-fluid";return(0,h.jsx)(a,(0,r.Z)((0,r.Z)({ref:t},l),{},{className:Z()(s,i?"".concat(d).concat(u):d)}))}));g.displayName="Container",g.defaultProps={fluid:!1};var N=g,j=n(43360),y=n(12009),_=function(e){for(var t=e.inputsData,n=e.handleSelectedServices,i=Math.ceil(t.length/8),o=[].concat((0,a.Z)(t.filter((function(e){return 1===e.contable}))),(0,a.Z)(t.filter((function(e){return 0===e.contable})))),r=[],c=0;c<i;c++){var s=8*c,l=s+8,d=o.slice(s,l).map((function(e){return(0,h.jsx)(y.UP,{inputData:e,handleSelectedServices:n},e.id)}));r.push((0,h.jsx)(m.Z,{className:"w-100 d-flex flex-column justify-content-start align-items-start gap-1 my-3",lg:4,xl:4,md:6,sm:6,children:d},"column-".concat(c)))}return(0,h.jsx)(f.Z,{className:"w-100",children:r})},S=n(24490),w=["id"],I=["id"],E=function(){var e=localStorage.getItem("form1-ID"),t=localStorage.getItem("form_quote_id"),n=(0,l.useState)([]),p=(0,s.Z)(n,2),Z=p[0],x=p[1],b=(0,l.useState)({quote_id:t,discount_id:0,items:[]}),g=(0,s.Z)(b,2),y=g[0],E=g[1],k=(0,l.useState)(null),q=(0,s.Z)(k,2),C=q[0],A=q[1],L=(0,v.i)(),R=L.getAllData,T=L.isLoading,O=L.error,P=(0,S.fg)().handlerRedirect,D=(0,u.TH)(),M=(0,u.s0)(),z=function(e,t){e.id;var n=(0,c.Z)(e,w),i=t.target.value.replace(/^0+|[^0-9]/g,""),o=y.items.some((function(t){return t.item_id==e.id})),s=Z.map((function(t){return t.id===e.id?(0,r.Z)((0,r.Z)({},t),{},{quotes:i}):t}));if(o||0==Number(i)||""==i)if(0===Number(i)||""===i){var l=y.items.filter((function(t){return t.item_id!=e.id}));E((function(e){return(0,r.Z)((0,r.Z)({},e),{},{items:l})}))}else{var d=y.items.map((function(t){return t.item_id===e.id?(0,r.Z)((0,r.Z)({},t),{},{value:i}):t}));E((function(e){return(0,r.Z)((0,r.Z)({},e),{},{items:d})}))}else E((function(t){return(0,r.Z)((0,r.Z)({},t),{},{items:[].concat((0,a.Z)(t.items),[(0,r.Z)({item_id:e.id,value:i},n)])})}));x(s)},U=function(e){e.id;var t=(0,c.Z)(e,I);if(y.items.some((function(t){return t.item_id===e.id}))){var n=Z.map((function(t){return t.id===e.id?(0,r.Z)((0,r.Z)({},t),{},{quotes:0}):t})),i=y.items.filter((function(t){return t.item_id!=e.id}));E((function(e){return(0,r.Z)((0,r.Z)({},e),{},{items:i})})),x(n)}else{var o=Z.map((function(t){return t.id===e.id?1===e.id||2===e.id?(console.log("ENTRA EN QUOTE ITEM"),(0,r.Z)((0,r.Z)({},t),{},{quotes:1,value:C})):(0,r.Z)((0,r.Z)({},t),{},{quotes:1}):t}));1===e.id||2===e.id?(console.log("ENTRA EN EL ID:",C),E((function(n){return(0,r.Z)((0,r.Z)({},n),{},{items:[].concat((0,a.Z)(n.items),[(0,r.Z)((0,r.Z)({},t),{},{item_id:e.id,value:C})])})}))):E((function(n){return(0,r.Z)((0,r.Z)({},n),{},{items:[].concat((0,a.Z)(n.items),[(0,r.Z)((0,r.Z)({},t),{},{item_id:e.id,value:1})])})})),console.log({updatedItemsData:o}),x(o)}};(0,l.useEffect)((function(){P(e);var n=function(){var n=(0,o.Z)((0,i.Z)().mark((function n(){var o,c,s,l,d,u;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,R("api/items/forQuoteType/".concat(e));case 3:if(o=n.sent,x((function(e){return(0,a.Z)(o)})),!e||!t){n.next=19;break}return n.next=8,R("api/quotes/items/".concat(t));case 8:if(c=n.sent,A(null===c||void 0===c?void 0:c.units),D.state){n.next=19;break}return n.next=13,R("api/quotes/items/".concat(t));case 13:s=n.sent,l=o.map((function(e){var t=null===s||void 0===s?void 0:s.content.find((function(t){return t.item_price_id==e.id}));if(t)return(0,r.Z)((0,r.Z)({},e),{},{id:t.item_price_id,name:t.name,quotes:null===t||void 0===t?void 0:t.quantity});if(3===e.id){var n=Math.round((null===s||void 0===s?void 0:s.units)/100);return(0,r.Z)((0,r.Z)({},e),{},{quotes:n})}return(0,r.Z)({},e)})),d=[],o.forEach((function(e){var t=null===s||void 0===s?void 0:s.content.find((function(t){return t.item_price_id==e.id}));if(t)d.push({item_id:t.item_price_id,name:null===t||void 0===t?void 0:t.name,value:null===t||void 0===t?void 0:t.quantity,discount:null===t||void 0===t?void 0:t.discount,is_discount_percentage:null===t||void 0===t?void 0:t.is_discount_percentage,price:null===t||void 0===t?void 0:t.price});else if(console.log({inputData:e}),3===e.id){var n=Math.round((null===s||void 0===s?void 0:s.units)/100);d.push({item_id:e.id,name:null===e||void 0===e?void 0:e.name,value:n,discount:0,is_discount_percentage:0,price:null===e||void 0===e?void 0:e.price})}})),E((function(e){return(0,r.Z)((0,r.Z)({},e),{},{items:d})})),x(l);case 19:null!==D&&void 0!==D&&D.state&&(E(null===D||void 0===D?void 0:D.state),u=null===o||void 0===o?void 0:o.map((function(e){var t,n=null===D||void 0===D||null===(t=D.state)||void 0===t?void 0:t.items.find((function(t){return t.item_id===e.id}));return n?(0,r.Z)((0,r.Z)({},e),{},{quotes:n.value}):e})),x(u)),n.next=24;break;case 22:n.prev=22,n.t0=n.catch(0);case 24:case"end":return n.stop()}}),n,null,[[0,22]])})));return function(){return n.apply(this,arguments)}}();n()}),[e]);return O?(0,h.jsx)(d.bI,{baseURL:"#",title:"Error",subtitle:"".concat(null===O||void 0===O?void 0:O.message)}):(0,h.jsxs)("div",{children:[(0,h.jsx)(d.cI,{items:["INICIO","VENTAS","LISTA COTIZACIONES","vista previa"],baseURL:["inicio","nexos/ventasconfirmaciones","nexos/listarcotizaciones",""]}),(0,h.jsx)(f.Z,{className:"d-flex justify-content-center align-items-center",children:(0,h.jsx)(m.Z,{sm:4,lg:6,className:"d-flex justify-content-center",children:(0,h.jsx)(d.r3,{title:"PASO 4",subtitle:"SELECCIONE LOS SERVICIO A COTIZAR",align:"center"})})}),(0,h.jsxs)(N,{className:"d-flex flex-column justify-content-center align-items-center",children:[T&&(0,h.jsx)(d.aN,{}),!O&&(0,h.jsx)(_,{inputsData:Z,handleSelectedServices:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";0===e.contable?U(e):z(e,t)}}),!T&&!O&&(0,h.jsx)("div",{className:"w-100 d-flex justify-content-end mb-5",children:(0,h.jsx)(j.Z,{style:{},className:"btn btn-primary d-none d-md-block",onClick:function(){localStorage.removeItem("create_quote_id"),M("".concat("","/nexos/seleccionados/"),{state:y})},children:"CONTINUAR"})})]})]})}},12009:function(e,t,n){n.d(t,{UP:function(){return I},$R:function(){return y}});var i=n(72791),o=n(80184),a=n(79627),r=n(1413),c=n(45987),s=n(81694),l=n.n(s),d=(n(42391),n(80239)),u=n(41337),v=n(10162),f=n(29439),m=n(39007),p=n(24787),Z=n(78633),x=["bsPrefix","active","disabled","eventKey","className","variant","action","as"],h=i.forwardRef((function(e,t){var n=e.bsPrefix,i=e.active,a=e.disabled,s=e.eventKey,d=e.className,u=e.variant,h=e.action,b=e.as,g=(0,c.Z)(e,x);n=(0,v.vE)(n,"list-group-item");var N=(0,p.v)((0,r.Z)({key:(0,Z.h)(s,g.href),active:i},g)),j=(0,f.Z)(N,2),y=j[0],_=j[1],S=(0,m.Z)((function(e){if(a)return e.preventDefault(),void e.stopPropagation();y.onClick(e)}));a&&void 0===g.tabIndex&&(g.tabIndex=-1,g["aria-disabled"]=!0);var w=b||(h?g.href?"a":"button":"div");return(0,o.jsx)(w,(0,r.Z)((0,r.Z)((0,r.Z)({ref:t},g),y),{},{onClick:S,className:l()(d,n,_.isActive&&"active",a&&"disabled",u&&"".concat(n,"-").concat(u),h&&"".concat(n,"-action"))}))}));h.displayName="ListGroupItem";var b=h,g=["className","bsPrefix","variant","horizontal","numbered","as"],N=i.forwardRef((function(e,t){var n,i=(0,d.Ch)(e,{activeKey:"onSelect"}),a=i.className,s=i.bsPrefix,f=i.variant,m=i.horizontal,p=i.numbered,Z=i.as,x=void 0===Z?"div":Z,h=(0,c.Z)(i,g),b=(0,v.vE)(s,"list-group");return m&&(n=!0===m?"horizontal":"horizontal-".concat(m)),(0,o.jsx)(u.Z,(0,r.Z)((0,r.Z)({ref:t},h),{},{as:x,className:l()(a,b,f&&"".concat(b,"-").concat(f),n&&"".concat(b,"-").concat(n),p&&"".concat(b,"-numbered"))}))}));N.displayName="ListGroup";var j=Object.assign(N,{Item:b}),y=function(e){var t=e.listMenu,n=e.selectedSearchResult,r=e.showListMenu,c=e.setShowListMenu,s=(0,i.useRef)(),l=function(e){r&&s.current&&!s.current.contains(e.target)&&c(!1)};return(0,i.useEffect)((function(){return document.addEventListener("click",l),function(){document.removeEventListener("click",l)}}),[r]),(0,o.jsx)(a.Z,{style:{position:"absolute",left:"0",width:"100%",overflow:"hidden",top:"110%",zIndex:1e3,border:"1px solid #9c9ca1"},ref:s,children:(0,o.jsx)(a.Z.Body,{children:(0,o.jsx)(j,{className:"overflow-auto",style:{maxHeight:"200px"},children:null===t||void 0===t?void 0:t.map((function(e){return(0,o.jsx)(a.Z.Text,{className:"px-3 py-2 cursor-pointer hover_selected_bg",style:{width:"100%",display:"flex",alignItems:"center",borderBottom:"1px solid #9c9ca1"},onClick:function(){return n(e)},children:e.name},e.id)}))})})})},_=n(20160),S=function(e){var t=e.item,n=e.handleSelectedServices;return(0,o.jsx)("div",{className:"w-100 mb-2 p-2 bg-white rounded shadow-sm",style:{border:"3px solid ".concat((null===t||void 0===t?void 0:t.quotes)>0?"#fd7e14":"#cdd4e2")},children:(0,o.jsxs)(_.Z.Label,{className:"custom-control custom-checkbox",children:[(0,o.jsx)(_.Z.Control,{type:"checkbox",className:"custom-control-input",name:"profiles",value:null===t||void 0===t?void 0:t.id,checked:(null===t||void 0===t?void 0:t.quotes)>0,onChange:function(){return n(t)}}),(0,o.jsx)("span",{className:"custom-control-label font-weight-bold",style:{color:"#4A4A69"},children:null===t||void 0===t?void 0:t.name})]})})},w=function(e){var t=e.item,n=e.handleSelectedServices;return(0,o.jsxs)("div",{className:"w-100 d-flex justify-content-between align-items-center gap-2 mb-2 bg-white rounded p-2 shadow-sm",style:{border:"3px solid ".concat((null===t||void 0===t?void 0:t.quotes)>0?"#fd7e14":"#cdd4e2")},children:[(0,o.jsx)(_.Z.Label,{className:"font-weight-bold",style:{color:"#4A4A69"},children:t.name}),(0,o.jsx)("input",{type:"number",className:"text-center py-2 rounded",style:{width:"80px",border:"2px solid ".concat((null===t||void 0===t?void 0:t.quotes)>0?"#fd7e14":"#cdd4e2")},name:"sort",value:(null===t||void 0===t?void 0:t.quotes)||0,onChange:function(e){return n(t,e)}})]})},I=function(e){var t=e.inputData,n=e.handleSelectedServices;return 1===t.contable?(0,o.jsx)(w,{item:t,handleSelectedServices:n}):(0,o.jsx)(S,{item:t,handleSelectedServices:n})}}}]);
//# sourceMappingURL=6923.ec34ac9a.chunk.js.map